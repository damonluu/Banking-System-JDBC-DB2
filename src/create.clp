connect to cs157a;
CREATE TABLE P1.Customer (ID INT NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY(START WITH 100, INCREMENT BY 1, NO CACHE), Name VARCHAR(15) NOT NULL, Gender CHAR NOT NULL CHECK(Gender IN ('M', 'F')), Age INT NOT NULL CHECK(Age >= 0), Pin INT NOT NULL CHECK(Pin >= 0));
CREATE TABLE P1.Account ( Number INTEGER NOT NULL PRIMARY KEY GENERATED ALWAYS AS IDENTITY(START WITH 1000, INCREMENT BY 1, NO CACHE), ID INTEGER NOT NULL, Balance INTEGER NOT NULL CHECK(Balance >= 0), Type CHAR NOT NULL CHECK(Type IN ('C', 'S')), Status CHAR NOT NULL CHECK(Status IN ('A', 'I')), CONSTRAINT FK FOREIGN KEY(ID) REFERENCES P1.Customer(ID));
CREATE VIEW SumBalance AS SELECT ID, sum(balance) as totalBalance FROM P1.Account WHERE P1.Account.Status = 'A' GROUP BY ID;
terminate;
